{% include parallax.html src="/assets/img/ovale.jpg" %}
<footer>
  <div class="container-md beautiful-jekyll-footer">
    <div class="row">
      <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1">
      {% include social-networks-links.html %}
      {% if page.footer-extra %}
        <div class="footer-custom-content">
          {% for file in page.footer-extra %}
            {% include {{ file }} %}
          {% endfor %}
        </div>
      {% endif %}
      <p class="copyright text-muted">
      {% if site.author %}
        {{ site.author }}
        &nbsp;&bull;&nbsp;
      {% endif %}
      {{ site.time | date: '%Y' }}

      {% if site.url-pretty %}
        &nbsp;&bull;&nbsp;
        <span class="author-site">
          <a href="{% if site.url-canonical %}{{ site.url-canonical }}{% else %}{{ '' | absolute_url }}{% endif %}">{{ site.url-pretty }}</a>
        </span>
      {% endif %}

      {% if site.matomo %}
        {% if site.matomo.opt-out %}
          &nbsp;&bull;&nbsp;
          <a href="http://{{- site.matomo.uri -}}/index.php?module=CoreAdminHome&action=optOut" target="_blank" class="text_muted">Do-not-Track</a>
        {% endif %}
      {% endif%}
      </p>
      </div>
    </div>
  </div>
</footer>

<script>
/* Normalize navbar links to absolute URLs so they never nest under the current path. */
(function () {
  var domain = "{{ site.url | default: '' }}";
  if (!domain) { try { domain = window.location.origin; } catch (e) { domain = ''; } }

  // Language prefix based on current page.lang (Liquid inserts it at build time).
  var langPrefix = "{% if page.lang == 'fr' %}/fr{% else %}{% endif %}";

  // Which containers to sanitize (navbar + any language switch).
  var scopes = document.querySelectorAll('.navbar, .lang-switch');

  scopes.forEach(function(scope){
    scope.querySelectorAll('a[href]').forEach(function(a){
      var h = a.getAttribute('href');
      if (!h) return;

      // Skip external links, anchors, mailto/tel, and already-root-absolute.
      if (/^(?:https?:)?\/\//i.test(h) || h[0] === '/' || h[0] === '#' || /^mailto:|^tel:/i.test(h)) return;

      // Turn "contact" or "contact/" into "/contact/"
      if (h[h.length - 1] !== '/') h += '/';
      if (h[0] !== '/') h = '/' + h;

      var abs = (domain + langPrefix + h)
        .replace(/([^:]\/)\/+/g, '$1')   // collapse doubles
        .replace(/^https:\/\//, 'https://');

      a.setAttribute('href', abs);
    });
  });
})();
</script>